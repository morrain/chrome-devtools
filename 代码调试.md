## 使用谷歌开发者工具进行代码调试

如下教程介绍了使用谷歌开发者工具调试JavaScript的基本步骤。虽然教程以一个特定问题的例子进行讲解，但基本的调试方法对所有JavaScript问题都适用。如果你还在用`console.log()`来调试并修复你代码中的问题，那么你可以考虑使用如下教程中介绍的方法，你会发现它更高效，定位问题更快。

### 第一步：重现问题

重现问题一般是解决问题的第一步。“重现问题”就是说找到通过一系列的操作使问题重复出现的方法。您可能需要重现多次，尽可能地排除任何不必要的步骤。

按照以下说明重现本教程中需要修复的问题：

1. 打开[**Demo**](https://googlechrome.github.io/devtools-samples/debug-js/get-started).  Demo会在一个新窗口中打开.
2. 在**数字1**输入框中输入5.
3. 在**数字2**输入框中输入1.
4. 点击**“数字1，数字2求和”**.
5. 会看到结果显示`5 + 1 = 51`.

显而易见，结果是不对的，正确的结果应该是6.那么接下来，我们来查找哪里出了问题。

### 第二步：使用断点

谷歌开发者工具可以让JavaScript代码在执行过程中，暂停下来，进而查看当时所有变量的值。我们把中断代码执行的标记称为**断点**。赶紧试一下吧：

1. 在Demo页面[打开谷歌开发者工具](配置开发者工具.md)
2. 切换到**Sources**面板

    1. 点击**Event Listener Breakpoints**展开**事件断点**窗口。该窗口列举了一系列可以展开的事件类别，如**Animation**、**Clipboard**等等。
    2. 在**Mouse**事件左侧，有一个展开的小箭头![](https://developers.google.cn/web/tools/chrome-devtools/images/expand.png). 点击展开，会看到一系列可以勾选的鼠标事件，如`click`,`dblclick`等等
    3. 勾选**`click`**事件
    
    ![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/get-started-click-breakpoint.png)
    
     > 如图所示 鼠标点击的事件断点被开启。当窗口足够大时 **Event Listener Breakpoints** 会显示在右侧，而不像本例中显示在下方。
     
3. 返回到Demo页面，点击**“数字1，数字2求和”**摁钮，程序会中断执行，**Sources**面板会有一行代码高亮显示，本例中高亮显示的为：

   `function onClick() {`
   
当勾选了**click**事件后，便开启了鼠标点击的事件断点。在浏览器内任意注册过点击事件的节点上单击，谷歌开发者工具自动中断在点击事件处理函数的第一行。

> 点击事件只是众多事件中的一种，实际使用什么事件断点取决于你要解决什么问题，要根据实际情况，不可同一而论。

### 第三步：逐步执行

通常造成问题的原因是脚本执行的顺序不对。通过逐步执行可以跟踪你的代码执行的每一步，一行代码一行代码执行，找到哪里执行的不对，不是你本来想要的预期。赶紧来试一下吧：

1. 在**Sources**面板，点击**跳转到函数内执行**摁钮(![](https://developers.google.cn/web/tools/chrome-devtools/images/step-into.png))，代码将进入到`onClick`函数内部执行，此时，谷歌开发者高亮如下一行代码：

  `if (inputsAreEmpty()) {`
  
2. 点击**跳过函数执行**摁钮（![](https://developers.google.cn/web/tools/chrome-devtools/images/step-over.png)）.谷歌开发者工具直接执行完`inputsAreEmpty()`函数，并不会跳到函数内部执行。注意谷歌开发者工具会跳过几行代码，因为`inputsAreEmpty()`值为false,所以`if`语句块中的代码不会被执行。

如上所述是逐步跟踪代码的基本方法.如果你看过`get-started.js`的代码，你会发现问题可能出在`updateLabel()`函数的某个地方。此时，你可不用从头开始逐步执行，你可以通过更快捷的途径把断点设置在离问题最近的地方。

### 设置代码行断点

代码行断点是断点中最常用的，你可以指定你想要中断的代码行。

1. 找到`updateLabel()`函数中的最后一行代码：

  `label.textContent = addend1 + ' + ' + addend2 + ' = ' + sum;`
2. 在代码左侧，可以看到代码行号，本例中为**32**。点击行号，便会在该行设置代码行断点，此时有一个蓝色的箭头标识(![](http://p1.bpimg.com/582863/5fb230d1dcd6cc16.png))。设置代码行断点后，每次执行到此行时，都会中断执行。
3. 点击**恢复脚本运行**摁钮(![](https://developers.google.cn/web/tools/chrome-devtools/images/resume-script-execution.png))，代码会恢复执行，只到遇到断点才会中断执行。
4. 返回到Demo页面，点击**“数字1，数字2求和”**摁钮，代码中断到`updateLabel()`最后一行，此时谷歌开发者工具会显示出`addend1`,`addend2`和`sum`的值。

  ![](http://p1.bpimg.com/582863/f0466f741929ccf2.png)