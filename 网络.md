## 网络

谷歌开发者工具的**网络**面板，可以记录每一次网络请求的信息，包括详细的耗时信息，HTTP请求以及返回的数据等等，对于定位后台数据问题起到了至关重要的作用。

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/network-panel.png)

**总的来说本节包括如下内容**

* 使用**网络**面板记录、分析网络请求
* 对捕捉到的网络请求进行过滤和排序
* 保存、拷贝、清楚网络日志
* 根据需求自定义网络面板

### 网络面板总览

网络面板包括如下5个窗口：

1. **控件** 使用这些功能控制**网络**面板的展示和功能
2. **过滤器** 使用过滤器可以控制要在列表中显示哪些网络请求。摁住**Cmd**(Mac)或者**Ctrl**(Window)键，可以同时选择多个筛选条件。
3. **概览** 此图表显示了资源加载的时间线。如果在垂直方向上很多时间线重合，说明加载这些资源是同时进行的，有时序上的重叠。
4. **请求列表** 请求列表列举了捕获到的所有网络请求，默认以时间排序，最近的请求在最上面。点击请求的名字会显示网络请求的详情。在列表头上右击，可以添加或者删除要显示的列。
5. **概要** 该窗口显示请求的总数，数据传输量以及加载时间

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/panes.png)

### 捕获网络请求

打开**网络**面板时，默认开始捕获所有网络请求。可以刷新页面，捕获从页面加载开始发起的所有网络请求。还可以通过点击**record**摁钮来开启或者关闭捕获网络请求。当摁钮为红色（![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/record-on.png)）时谷歌开发者工具会记录，当为灰色（![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/record-off.png)）时不记录。

### 抓取快照

**网络**面板可以抓取页面加载时的快照。这个功能我们称之为**幻灯片**。点击摄像头图标来开启幻灯片功能，当开启时，图标亮起（![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/filmstrip-enabled.png)），关闭时，图标熄灭（![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/filmstrip-disabled.png)）。开启快照后，刷新页面，概览区域会显示抓取到的快照。

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/filmstrip.png)

鼠标移动到快照上，时间线上会显示一条黄色的垂直线，表示当前快照是什么时候捕获的。请见下图

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/filmstrip-timeline-overlay.png)

在快照上双击，会放大显示当前快照，快照被放大了之后，可以使用键盘上左右箭头键，对快照进行切换。

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/filmstrip-zoom.png)

### 查看DOMContentLoaded和load事件

首先，我们先了解一下这两个事件的区别。DOMContentLoaded事件会在load事件之前触发。DOM文档加载的步骤为：

1. 解析HTML结构。
2. 加载外部脚本和样式表文件。
3. 解析并执行脚本代码。
4. DOM树构建完成。//DOMContentLoaded
5. 加载图片等外部文件。
6. 页面加载完毕。//load

**网络**面板会特别高亮显示这两个事件的信息。DOMContentLoaded会在两个地方显示：

1. **概览**上一个垂直的蓝色的线，表示DOMContentLoaded事件触发的时刻
2. **概要**窗口可以看到精确的事件触发的时间

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/domcontentloaded.png)

**load**事件会在页面加载全部完成后触发，它会在三个地方显示：

1. **概览**上一个垂直的红色的线
2. **请求列表**上一个垂直的红色的线
3. **概要**窗口可以看到精确的事件触发的时间

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/load.png)

### 查看网络请求的详情

在**请求列表**中点击请求的名字，可以查看该网络请求的详情。根据网络请求类型的不同，详情页面显示的tabs可能会不一样，但如下四个基本都会显示。

* **Headers** 网络请求的HTTP头
* **Preview** Json、图片、文本资源预览
* **Response** 网络请求的响应信息
* **Timing** 网络请求生命周期的详细信息

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/network-headers.png)

更多详情请参考[网络](网络.md)一节。

#### 查看WebSocket框架

当网络请求是websocket时，网络详情窗口会显示**Frames**标签页。切换到**Frames**标签页可以查看websocket连接的相关信息。

![](https://developers.google.cn/web/tools/chrome-devtools/network-performance/imgs/websocket-frames.png)

**Frames**标签页包括如下几列信息：

* **Data** 通信消息。如果是文本，直接显示。如果二进制操作码，这里显示操作码的相关信息。一共有如下几种操作码：
    * Continuation Frame
    * Binary Frame
    * Connection Close Frame
    * Ping Frame
    * Pong Frame
* **Length** 消息的大小，以字节为单位
* **Time** 消息发送以及接收的时间戳

每一行会根据消息的类型显示不同的颜色：
* 发出的文本消息显示亮绿色
* 接受的文本消息显示白色
* 操作码显示亮黄色
* 出错显示亮红色

> 提示

> * 当有新消息到达时，可以点击左侧网络请求的名字进行刷新
> * **Frames**只会保留最近的100条消息进行显示


