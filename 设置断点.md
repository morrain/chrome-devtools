## 设置断点

断点可以中断代码执行，进而可以查看中断时的变量值以及当时的调用栈信息。断点设置后，如何通过单步执行排查问题，请参考下节[逐步执行](逐步执行.md)。

### 简而言之

* 通常情况，我们都会在特定代码行上设置[代码行断点](代码调试.md)。还可以为代码行断点设置特定条件，当条件满足时才会中断。
* 除了代码行断点外，还可以设置通用的条件断点，比如事件、异常、DOM、XHR等等。

### 设置代码行断点

当你知道要查看哪些语句时，在特定行上设置断点是非常有效的。例如，那你发现登陆的逻辑与预期不一致，而在你的代码中只有一个函数在处理登陆相关的逻辑，那么我们完全可以假定问题出在那个函数内部，在这种情况下，我们在这个函数的第一行添加断点是非常明智的。

当在某行上设置断点后，代码只要执行到这一行总是会中断下来，直到删除该断点，或者停用断点，或者为其设置条件。

打开**Sources**面板，从面板左侧的**文件导航**窗口选择要设置断点的文件，如果没找到**文件导航**窗口，点击展开收起**文件导航**的摁钮(![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/file-navigator.png))。

 > 提示：如果你调试的是混淆过的代码，你可以点击**格式化混淆代码**的摁钮![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/pretty-print.png)来格式化混淆过的代码。具体请参考[格式化混淆的代码](格式化混淆的代码.md)章节。
 
源文件左侧是**行号槽**，这里显示了源代码的行号，在行号槽上点击便在该行上设置了代码行断点。

  ![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/line-number-breakpoint.png)
  
如下图所示，如果某一表达式被分隔成多行，在表达式中间设置断点时，断点会自动设置在下一表达式的位置。例如，在图中第4号设置断点，断点会自动被设置在第6行。

![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/mid-expression-breakpoint.png)

#### 给代码行断点添加条件

在**行号槽**断点标记上右击，在弹出的菜单中选择**编辑断点**选项。在弹出的输入框中输入条件后回车，如下所示。当然对于没有设置的断点的行，也可以右击选择**添加条件断点**选项来添加条件断点。

![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/adding-condition.png)

条件断点的标记为金黄色用于和普通的条件断点进行区分。

![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/conditional-breakpoint.png)

#### 删除或者停用某一代码行断点

如果你想临时停用某一断点，你可以该断点的标记上右键，选择**Disable breakpoint**选项。

![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/disable-breakpoint.png)

同样，如果不再需要某断点了，右键选择**删除**断点选项。

你还可以通过**Sources**面板的**Breakpoints**窗口统一管理所有脚本文件上的代码行断点。删除断点，只需要在该断点上右击选择**删除断点**选项即可。如下图所示：

![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/breakpoints-pane.png)

停用某断点，只需要在断点左侧取消勾选。停用所有断点，右键选择**Disable All Breakpoints**。当然你还可以通过**Sources**面板上方的**停用所有断点**摁钮来停用所有断点。

![](http://p1.bpimg.com/582863/c0d3b6993dd69d49.png)

### 设置DOM断点

当页面上的DOM节点出现超出预期的变化时，使用DOM断点来调试会非常方便。当DOM节点发生改变、被删除、被添加子节点等变化时，并不用人工的去检查源代码哪里会导致这个问题，谷歌开发者工具允许你在DOM节点上添加断点。当该节点发生上面所述的变化时，谷歌开发者工具会中断在导致这个变化的那一行代码。

如下所示是一个实时的demo[(请参考原网站)](https://developers.google.cn/web/tools/chrome-devtools/javascript/add-breakpoints)的截图。当点击**INCREMENT**摁钮时，**Count**值会自增，进而导致DOM变化。你可以通过这个demo学习如何设置DOM断点，找到导致**Count**变化的代码。

![](http://i1.piimg.com/582863/3562da161adb646d.png)

1. 在**Count**上右击，选择**审查元素**，谷歌开发者工具会高亮选中该节点，本例中是一个`p`标签。
2. 在该节点上右键，选择**Break on**>**Subtree Modifications**选项，该节点最左侧显示一个蓝色的图标(![](https://developers.google.cn/web/tools/chrome-devtools/javascript/imgs/dom-breakpoint-icon.png))表明该节点上添加了DOM节点。节点被选中时，图标有点不太容易看到，如下图所示。
![](http://p1.bpimg.com/582863/bfdc4964e539692a.png)
3. 设置好DOM断点后，点击**INCREMENT**摁钮，谷歌会跳转到**Sources**面板，中断在导致DOM发生变化的那一行代码。如下图所示：
![](http://i1.piimg.com/582863/da71623f745e902f.png)
4. 点击**恢复代码执行**摁钮(![](https://developers.google.cn/web/tools/chrome-devtools/images/resume-script-execution.png))两次，可恢复代码执行。之所以会中断下来两次，是因为首先，DOM节点中的文本被删除，然后又被填入新值。所以，设置的子树修改断点会中断两次。

当希望选中DOM节点的属性发生变化或者选中的DOM节点被删除时中断下来，只需在上述第二步中，选择**Attributes modifications**以及**Node Removal**即可。

> 提示：这些类型的DOM断点并不是互斥的，你可以在同一个DOM结点上同时设置这三类断点

#### 临时停用断点

1. 返回到**Elements**面板
2. 在面板右侧(屏幕太小时，可能在下方)的**DOM Breakpoints**标签页，可以看到复选框，右边显示节点的标签名和断点的类型。
> 鼠标移动到标签名上方时，相应的DOM节点在页面上会被高亮，点击会在DOM树视图中选中该节点
3. 去掉勾选，即可临时停用该DOM节点
4. 再次点击**INCREMENT**摁钮，程序不会再中断了
